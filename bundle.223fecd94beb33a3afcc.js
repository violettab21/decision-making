(()=>{"use strict";var e={197:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Picker=void 0;const o=n(433),i=n(677),s=n(905);t.Picker=class{constructor(e,t){this.time=new i.ElementBase({tag:"input",className:["input-time"]}),this.time.element instanceof HTMLInputElement&&(this.time.element.type="number",this.time.element.min="5",this.time.element.max="30"),this.finalOption=new i.ElementBase({tag:"input",className:["input-final-option"]}),this.wheel=new s.Wheel,this.menuContainer=new i.ElementBase({tag:"div",className:["decision-menu"]}),this.configureMenu(e,t),e.main.element.append(this.wheel.wheelElement)}configureMenu(e,t){const n=new i.ElementBase({tag:"div",className:["top-elements"]}),s=new o.Button({className:["decision-back"],textContent:"Back",handlerFunction:()=>t.openPage("/")}),a=new o.Button({className:["decision-pick"],textContent:"Pick",handlerFunction:()=>{this.time.element instanceof HTMLInputElement?this.wheel.startWheel(1e3*parseInt(this.time.element.value),this.finalOption):this.wheel.startWheel(1e4,this.finalOption)}}),l=new i.ElementBase({tag:"label",className:["time-label"],textContent:"Duration"});l.element.append(this.time.element),this.time.element instanceof HTMLInputElement&&(this.time.element.value="10"),n.element.append(s.element,l.element),this.menuContainer.element.append(n.element,a.element),this.finalOption.element instanceof HTMLInputElement&&(this.finalOption.element.disabled=!0,this.finalOption.element.value="Spin the wheel"),e.main.element.append(this.menuContainer.element,this.finalOption.element)}}},237:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorage=void 0,t.LocalStorage=class{constructor(e){this.key=e}saveData(e){localStorage.setItem(this.key,JSON.stringify(e))}getData(){const e=localStorage.getItem(this.key);return null!==e?JSON.parse(e):[]}}},289:(e,t,n)=>{n.r(t)},365:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParseListModal=void 0;const o=n(677),i=n(433),s=n(820),a=n(237);class l extends s.Modal{constructor(e){super();const t=new o.ElementBase({tag:"textarea",className:["textarea"]});this.page=e,t.element instanceof HTMLTextAreaElement&&(this.inputForParse=t.element),this.configureModal()}configureModal(){const e=new o.ElementBase({tag:"div",className:["modal-content"]}),t=new o.ElementBase({tag:"div",className:["modal-buttons"]}),n=new i.Button({className:["button","button-confirm"],textContent:"Confirm",handlerFunction:()=>{this.createOptionsFromInput.call(this),new a.LocalStorage("decision-maker_options").saveData(this.page.getOptions())}}),s=new i.Button({className:["button","button-cancel"],textContent:"Cancel",handlerFunction:this.closeModal.bind(this)});t.element.append(n.element,s.element),this.inputForParse&&e.element.append(this.inputForParse,t.element),this.addModalContent(e)}createOptionsFromInput(){const e=this.parseInput();this.page.addOptionElements(e),this.closeModal()}parseInput(){var e;const t=null===(e=this.inputForParse)||void 0===e?void 0:e.value;return t?t.split("\n").map((e=>{const[t,n]=e.split(",");return{title:t,weight:n}})):[{title:"",weight:""}]}}t.ParseListModal=l},433:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;const o=n(677);class i extends o.ElementBase{constructor(e){super({tag:"button",className:e.className,textContent:e.textContent}),this.addHandler(e.handlerFunction)}addHandler(e){try{this.element.addEventListener("click",(t=>{"Delete"===t.target.textContent?e(t):e()}))}catch(e){console.error(e)}}}t.Button=i},613:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorPage=void 0;const o=n(433),i=n(677);t.ErrorPage=class{constructor(e,t){this.text=new i.ElementBase({tag:"p",className:["error-text"],textContent:"Page not found"}),this.button=new o.Button({className:["back"],textContent:"Back to main page",handlerFunction:()=>t.openPage("/")}),e.main.element.append(this.text.element,this.button.element)}}},656:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;const o=n(673),i=n(613),s=n(197),a=n(905);t.Router=class{constructor(e,t){this.routes=[],this.routes=this.setRoutes(e,t)}openPage(e){void 0!==e&&(history.pushState(null,"",e),console.log("added to history"));const t=window.location.pathname.substring(1),n=this.routes.find((e=>e.url===t));n?n.handler():(console.log("not found"),this.routes[3].handler())}setRoutes(e,t){return[{url:"options",handler:()=>{e.content?e.content instanceof s.Picker?(e.content.wheel.wheelElement.remove(),e.content.menuContainer.element.remove(),e.content.time.element.remove(),e.content.finalOption.element.remove(),e.content=new o.OptionsPage(e,this)):e.content instanceof i.ErrorPage&&(e.content.text.element.remove(),e.content.button.element.remove()):e.content=new o.OptionsPage(e,this)}},{url:"decision-picker",handler:()=>{e.content instanceof o.OptionsPage?(t.saveData(e.content.getOptions()),e.content.optionsContainer.element.remove(),e.content.buttonsContainer.element.remove(),e.content=new s.Picker(e,this)):e.content instanceof i.ErrorPage?(e.content.text.element.remove(),e.content.button.element.remove(),e.content=new s.Picker(e,this)):(0,a.getValidOptions)().length>=2?e.content=new s.Picker(e,this):(e.content=new o.OptionsPage(e,this),history.replaceState(null,"","/"))}},{url:"",handler:()=>{e.content instanceof s.Picker?(e.content.wheel.wheelElement.remove(),e.content.menuContainer.element.remove(),e.content.time.element.remove(),e.content.finalOption.element.remove(),e.content=new o.OptionsPage(e,this)):e.content instanceof i.ErrorPage?(e.content.text.element.remove(),e.content.button.element.remove(),e.content=new o.OptionsPage(e,this)):e.content=new o.OptionsPage(e,this)}},{url:"error",handler:()=>{e.content instanceof s.Picker?(e.content.wheel.wheelElement.remove(),e.content.menuContainer.element.remove(),e.content.time.element.remove(),e.content.finalOption.element.remove(),e.content=new i.ErrorPage(e,this)):e.content instanceof o.OptionsPage?(t.saveData(e.content.getOptions()),e.content.optionsContainer.element.remove(),e.content.buttonsContainer.element.remove(),e.content=new i.ErrorPage(e,this)):e.content=new i.ErrorPage(e,this)}}]}}},673:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsPage=void 0;const o=n(433),i=n(677),s=n(365),a=n(820),l=n(237),r=n(905);t.OptionsPage=class{constructor(e,t){this.buttonsContainer=new i.ElementBase({tag:"div",className:["buttons"]}),this.optionsContainer=new i.ElementBase({tag:"div",className:["options"]}),this.options=[],this.getOptionsFromStorage(),this.configureButtonsView(e,t),this.configureOptionsView()}configureButtonsView(e,t){var n;const s=new o.Button({className:["add_option"],textContent:"Add Option",handlerFunction:()=>{this.addOptionElement.call(this),new l.LocalStorage("decision-maker_options").saveData(this.getOptions())}}),c=new o.Button({className:["start"],textContent:"Start",handlerFunction:()=>{if((0,r.getValidOptions)().length<2){const t=new a.Modal,n=new i.ElementBase({tag:"p",className:["modal-message"],textContent:"Please, create at least 2 options with title and weight"});t.modal.element.append(n.element),e.main.element.append(t.modalContainer.element)}else t.openPage("decision-picker")}}),m=new o.Button({className:["parse_list"],textContent:"Parse List",handlerFunction:this.parseListHandler.bind(this,e.main.element)}),h=new o.Button({className:["save"],textContent:"Save options to File",handlerFunction:this.saveOptionsToFile.bind(this)}),p=new i.ElementBase({tag:"input",className:["file-input"]});if(p.element.id="upload-file",p.element instanceof HTMLInputElement){const e=p.element;e.type="file",e.addEventListener("change",(()=>{let t;if(console.log("readfile"),e.files){console.log("readfile2");const n=e.files[0];console.log(n);const o=new FileReader;o.readAsText(n),o.addEventListener("load",(()=>{if("string"==typeof o.result){const e=o.result;"object"==typeof JSON.parse(e)&&(t=JSON.parse(e),console.log(t),this.clearAllOptions(),this.addOptionElements(t),new l.LocalStorage("decision-maker_options").saveData(this.getOptions()))}}))}})),"file"===e.type&&(e.accept="application/json")}p.element.style.display="none";const d=new o.Button({className:["upload"],textContent:"Upload options from File",handlerFunction:()=>{const e=document.getElementById("upload-file");null!==e&&e.click()}}),u=new o.Button({className:["clear"],textContent:"Clear All Options",handlerFunction:this.clearAllOptions.bind(this)});this.buttonsContainer.element.append(s.element,c.element,m.element,h.element,d.element,p.element,u.element),null===(n=e.main.element)||void 0===n||n.append(this.buttonsContainer.element)}configureOptionsView(){this.buttonsContainer.element.before(this.optionsContainer.element),0===this.options.length?this.addOptionElement():this.addOptionElements(this.options)}addOptionElement(e){var t;const n=new i.ElementBase({tag:"div",className:["option"]}),s=(null==e?void 0:e.id)?e.id:`#${this.generateIdForOption()}`,a=new i.ElementBase({tag:"p",className:["option-number"],textContent:s}),r=new i.ElementBase({tag:"input",className:["option-input"]});r.element instanceof HTMLInputElement&&(null==e?void 0:e.title)&&(r.element.value=e.title),r.element instanceof HTMLInputElement&&(r.element.placeholder="Option Title"),r.element.addEventListener("change",(()=>{new l.LocalStorage("decision-maker_options").saveData(this.getOptions())}));const c=new i.ElementBase({tag:"input",className:["option-input","input-weight"]});c.element instanceof HTMLInputElement&&(null==e?void 0:e.weight)&&(c.element.value=e.weight),c.element instanceof HTMLInputElement&&(c.element.type="number",c.element.min="0.1",c.element.placeholder="Weight"),c.element.addEventListener("change",(()=>{new l.LocalStorage("decision-maker_options").saveData(this.getOptions())}));const m=new o.Button({className:["delete"],textContent:"Delete",handlerFunction:e=>{if(e){const t=e.target.parentElement;t&&t.remove(),new l.LocalStorage("decision-maker_options").saveData(this.getOptions())}}});n.element.append(a.element,r.element,c.element,m.element),null===(t=this.optionsContainer)||void 0===t||t.element.append(n.element)}addOptionElements(e){e.forEach((e=>this.addOptionElement(e)))}generateIdForOption(){let e,t=0;const n=this.optionsContainer.element.children.length;if(0===n)return 1;{const o=this.optionsContainer.element.children.item(n-1);null!==o&&(e=o.children.item(0).textContent,e&&(t=parseInt(e.slice(1))))}return t+1}parseListHandler(e){const t=new s.ParseListModal(this);e.append(t.modalContainer.element)}saveOptionsToFile(){const e=JSON.stringify(this.getOptions()),t=new File([e],"options.json",{type:"application/json"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="options.json",o.click()}clearAllOptions(){if(0!==this.optionsContainer.element.children.length){const e=this.optionsContainer.element.children;Array.from(e).forEach((e=>e.remove()))}}getOptions(){const e=[];if(0!==this.optionsContainer.element.children.length){const t=this.optionsContainer.element.children;for(const n of t){const t=Array.from(n.children).slice(0,3).map((e=>e instanceof HTMLInputElement?e.value?e.value:"":e.textContent?e.textContent:"")),[o,i,s]=t,a={id:o,title:i,weight:s};e.push(a)}}return e}getOptionsFromStorage(){const e=new l.LocalStorage("decision-maker_options").getData();this.options=e}}},675:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const o=n(656),i=n(768),s=n(237);t.App=class{constructor(){this.main=new i.Main,this.localStorage=new s.LocalStorage("decision-maker_options"),this.router=new o.Router(this.main,this.localStorage),document.addEventListener("DOMContentLoaded",(()=>{this.router.openPage()})),window.addEventListener("popstate",(()=>{console.log("popstate event triggered"),this.router.openPage()}))}}},677:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ElementBase=void 0,t.ElementBase=class{constructor(e){this.properties=e,this.element=this.createElement(),this.addClasses(),this.setContent()}createElement(){return document.createElement(this.properties.tag)}addClasses(){this.properties.className.forEach((e=>this.element.classList.add(e)))}setContent(){this.element.textContent=this.properties.textContent?this.properties.textContent:""}}},684:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});const o=n.p+"fdaba3d27bc321d0775803fac6189782.svg"},768:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Main=void 0;const o=n(677);t.Main=class{constructor(){this.pageTitle=new o.ElementBase({tag:"p",className:["title"],textContent:"Decision Making Tool"}),this.main=new o.ElementBase({tag:"main",className:["main"]}),this.configurePageView(),this.content=null}configurePageView(){var e;this.main.element.append(this.pageTitle.element),null===(e=document.querySelector("body"))||void 0===e||e.append(this.main.element)}}},820:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;const i=n(677),s=o(n(684));t.Modal=class{constructor(){this.modalContainer=new i.ElementBase({tag:"div",className:["dark-view"]}),this.modal=new i.ElementBase({tag:"div",className:["modal"]}),this.configureBaseModal()}configureBaseModal(){const e=new i.ElementBase({tag:"span",className:["icon-close"]});e.element.addEventListener("click",(()=>{this.closeModal()})),this.modalContainer.element.addEventListener("click",(e=>{e.target===e.currentTarget&&this.closeModal()}));const t=new Image;t.src=s.default,e.element.append(t),this.modalContainer.element.append(this.modal.element),this.modal.element.append(e.element),document.addEventListener("keydown",(e=>{"Escape"==e.code&&this.closeModal()}))}addModalContent(e){this.modal.element.append(e.element)}closeModal(){this.modalContainer.element.remove()}}},905:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Wheel=void 0,t.getValidOptions=i;const o=n(237);function i(){return new o.LocalStorage("decision-maker_options").getData().filter((e=>0!==e.title.length&&0!==e.weight.length))}function s(){const e=i(),t=function(e){const t=[];for(let n=0;n<e;n+=1){let n=Math.floor(Math.random()*e);for(;t.includes(n);)n=Math.floor(Math.random()*e);t.push(n)}return t}(e.length),n=[];return t.forEach((t=>n.push(e[t]))),n}t.Wheel=class{constructor(){this.wheelElement=document.createElement("canvas"),this.wheelElement.width=500,this.wheelElement.height=450,this.rotation=0,this.options=s(),this.colors=this.generateColors(),this.drawWheel(this.rotation,this.options),this.duration=1e4,this.isSpinning=!1,this.startTime=0,s()}drawWheel(e,t,n){const o=this.wheelElement.getContext("2d");if(o){o.clearRect(0,0,400,250);const i=this.wheelElement.width/2,s=this.wheelElement.height/2;let a=0,l=e,r=0;for(let e=0;e<t.length;e+=1)a+=parseInt(t[e].weight);const c=2*Math.PI/a;for(let e=0;e<t.length;e+=1){r=l+c*parseInt(t[e].weight),o.beginPath(),o.arc(i,s,220,l,r);const a=i+110*Math.cos(l+(r-l)/2),m=s+110*Math.sin(l+(r-l)/2);o.lineTo(i,s),o.closePath(),o.strokeStyle="yellow",o.lineWidth=3,o.stroke(),o.fillStyle=this.colors[e],o.fill(),o.save(),o.translate(a,m),o.rotate(l+(r-l)/2),o.font="30px Arial",o.fillStyle="black",o.fillText(t[e].title,-10,0),o.restore(),(l%(2*Math.PI)<3*Math.PI/2&&r%(2*Math.PI)>3*Math.PI/2&&n||l<3*Math.PI/2&&r>3*Math.PI/2&&n)&&(n.element instanceof HTMLInputElement&&(n.element.value=t[e].title),console.log(t[e].title)),l=r}o.beginPath(),o.moveTo(i,15),o.lineTo(i+10,0),o.lineTo(i-10,0),o.lineTo(i,15),o.fillStyle="white",o.fill(),o.beginPath(),o.moveTo(i,s),o.arc(i,s,20,0,2*Math.PI),o.fillStyle="white",o.fill()}}animateWheel(e,t){const n=(performance.now()-this.startTime)/this.duration<1?(performance.now()-this.startTime)/this.duration:1,o=2*Math.PI*e*(i=n,-(Math.cos(Math.PI*i)-1)/2);var i;this.rotation=o,n<1?(this.drawWheel(this.rotation,this.options,t),window.requestAnimationFrame((()=>this.animateWheel(e,t)))):this.isSpinning=!1}startWheel(e,t){this.duration=e;const n=this.generateRotationCount();this.isSpinning||(this.isSpinning=!0,this.rotation=0,this.startTime=performance.now(),window.requestAnimationFrame((()=>this.animateWheel(n,t))))}generateColors(){const e=[];return this.options.forEach((()=>e.push(function(){const e=[0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F"];let t="";for(let n=0;n<6;n+=1)t+=e[Math.floor(16*Math.random())];return`#${t}`}()))),e}generateRotationCount(){return 2*Math.random()+this.duration/1e3}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var i=o.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=o[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n(289),new(n(675).App)})();
//# sourceMappingURL=bundle.223fecd94beb33a3afcc.js.map